                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="p-3 text-sm font-medium text-gray-600">User</th>
                                    <th class="p-3 text-sm font-medium text-gray-600">Email</th>
                                    <th class="p-3 text-sm font-medium text-gray-600">Plan</th>
                                    <th class="p-3 text-sm font-medium text-gray-600">DMs Used</th>
                                    <th class="p-3 text-sm font-medium text-gray-600">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminUsersTable" class="divide-y">
                                <tr>
                                    <td colspan="5" class="p-4 text-center text-gray-500">Loading users...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Plan Management -->
                <div class="glass-card rounded-2xl p-6 shadow-sm mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">Plan Management</h3>
                        <button onclick="showPlanEditor()" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                            <i class="fas fa-edit mr-2"></i> Edit Plans
                        </button>
                    </div>
                    
                    <div class="grid sm:grid-cols-3 gap-4">
                        <div class="p-4 bg-gray-50 rounded-xl">
                            <h4 class="font-semibold text-gray-800">Starter Plan</h4>
                            <p class="text-2xl font-bold text-purple-600">‚Çπ499</p>
                            <p class="text-sm text-gray-500">500 DMs/month</p>
                            <p class="text-sm text-gray-500">1 Account</p>
                        </div>
                        <div class="p-4 bg-purple-50 rounded-xl">
                            <h4 class="font-semibold text-gray-800">Pro Plan</h4>
                            <p class="text-2xl font-bold text-purple-600">‚Çπ999</p>
                            <p class="text-sm text-gray-500">2000 DMs/month</p>
                            <p class="text-sm text-gray-500">3 Accounts</p>
                        </div>
                        <div class="p-4 bg-green-50 rounded-xl">
                            <h4 class="font-semibold text-gray-800">Enterprise</h4>
                            <p class="text-2xl font-bold text-purple-600">‚Çπ2499</p>
                            <p class="text-sm text-gray-500">Unlimited DMs</p>
                            <p class="text-sm text-gray-500">10 Accounts</p>
                        </div>
                    </div>
                </div>
                
                <!-- Pending Payments -->
                <div class="glass-card rounded-2xl p-6 shadow-sm">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Pending UPI Payments</h3>
                    <div id="pendingPayments" class="space-y-3">
                        <p class="text-gray-500 text-center py-4">No pending payments</p>
                    </div>
                </div>
            </section>
        </main>
    </div>
</div>

<!-- ============================== -->
<!-- ADMIN PANEL -->
<!-- ============================== -->
<div id="adminPanel" class="hidden min-h-screen bg-gray-900 text-white">
    <div class="flex h-screen">
        <!-- Sidebar -->
        <aside class="w-64 bg-gray-800 p-6">
            <div class="flex items-center space-x-2 mb-8">
                <div class="w-10 h-10 bg-gradient-to-r from-red-600 to-orange-600 rounded-xl flex items-center justify-center">
                    <i class="fas fa-shield-alt text-xl"></i>
                </div>
                <span class="text-xl font-bold">Admin Panel</span>
            </div>
            
            <nav class="space-y-2">
                <a href="#" onclick="showAdminSection('overview')" class="admin-nav flex items-center space-x-3 px-4 py-3 rounded-xl bg-red-600">
                    <i class="fas fa-chart-pie w-5"></i><span>Overview</span>
                </a>
                <a href="#" onclick="showAdminSection('users')" class="admin-nav flex items-center space-x-3 px-4 py-3 rounded-xl hover:bg-gray-700">
                    <i class="fas fa-users w-5"></i><span>Users</span>
                </a>
                <a href="#" onclick="showAdminSection('plans')" class="admin-nav flex items-center space-x-3 px-4 py-3 rounded-xl hover:bg-gray-700">
                    <i class="fas fa-tags w-5"></i><span>Plans & Pricing</span>
                </a>
                <a href="#" onclick="showAdminSection('payments')" class="admin-nav flex items-center space-x-3 px-4 py-3 rounded-xl hover:bg-gray-700">
                    <i class="fas fa-credit-card w-5"></i><span>Payments</span>
                </a>
                <a href="#" onclick="showAdminSection('accounts')" class="admin-nav flex items-center space-x-3 px-4 py-3 rounded-xl hover:bg-gray-700">
                    <i class="fab fa-instagram w-5"></i><span>IG Accounts</span>
                </a>
                <a href="#" onclick="showAdminSection('settings')" class="admin-nav flex items-center space-x-3 px-4 py-3 rounded-xl hover:bg-gray-700">
                    <i class="fas fa-cog w-5"></i><span>Settings</span>
                </a>
            </nav>
            
            <div class="absolute bottom-6 left-6 right-6">
                <button onclick="showLandingPage()" class="w-full py-3 bg-purple-600 rounded-xl font-medium hover:bg-purple-700 transition mb-2">
                    <i class="fas fa-home mr-2"></i> Back to Site
                </button>
                <button onclick="adminLogout()" class="w-full py-3 bg-red-600 rounded-xl font-medium hover:bg-red-700 transition">
                    <i class="fas fa-sign-out-alt mr-2"></i> Logout
                </button>
            </div>
        </aside>
        
        <!-- Main Content -->
        <main class="flex-1 overflow-y-auto bg-gray-900 p-8">
            
            <!-- Overview Section -->
            <section id="overviewSection">
                <h1 class="text-3xl font-bold mb-8">Dashboard Overview</h1>
                
                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-gray-800 rounded-2xl p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm">Total Users</p>
                                <h3 id="adminTotalUsers2" class="text-3xl font-bold">0</h3>
                            </div>
                            <div class="w-12 h-12 bg-purple-600/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-users text-purple-500 text-xl"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-800 rounded-2xl p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm">Active Subscriptions</p>
                                <h3 id="adminActiveSubscriptions" class="text-3xl font-bold">0</h3>
                            </div>
                            <div class="w-12 h-12 bg-green-600/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-check-circle text-green-500 text-xl"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-800 rounded-2xl p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm">Total Revenue</p>
                                <h3 id="adminTotalRevenue" class="text-3xl font-bold">‚Çπ0</h3>
                            </div>
                            <div class="w-12 h-12 bg-yellow-600/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-rupee-sign text-yellow-500 text-xl"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-800 rounded-2xl p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm">Total DMs Sent</p>
                                <h3 id="adminTotalDmsSent" class="text-3xl font-bold">0</h3>
                            </div>
                            <div class="w-12 h-12 bg-blue-600/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-paper-plane text-blue-500 text-xl"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Charts -->
                <div class="grid lg:grid-cols-2 gap-6 mb-8">
                    <div class="bg-gray-800 rounded-2xl p-6">
                        <h3 class="text-lg font-semibold mb-4">User Growth</h3>
                        <canvas id="userGrowthChart" height="250"></canvas>
                    </div>
                    <div class="bg-gray-800 rounded-2xl p-6">
                        <h3 class="text-lg font-semibold mb-4">Revenue</h3>
                        <canvas id="revenueChart" height="250"></canvas>
                    </div>
                </div>
            </section>
            
            <!-- Users Section -->
            <section id="usersSection" class="hidden">
                <div class="flex items-center justify-between mb-8">
                    <h1 class="text-3xl font-bold">User Management</h1>
                    <div class="flex gap-4">
                        <input type="text" id="userSearch" placeholder="Search users..." class="px-4 py-2 bg-gray-800 border border-gray-700 rounded-xl text-white" oninput="searchUsersAdmin()">
                        <button onclick="exportUsers()" class="px-4 py-2 bg-green-600 rounded-xl hover:bg-green-700 transition">
                            <i class="fas fa-download mr-2"></i> Export
                        </button>
                    </div>
                </div>
                
                <div class="bg-gray-800 rounded-2xl overflow-hidden">
                    <table class="w-full">
                        <thead class="bg-gray-700">
                            <tr>
                                <th class="px-6 py-4 text-left text-sm font-medium text-gray-300">User</th>
                                <th class="px-6 py-4 text-left text-sm font-medium text-gray-300">Email</th>
                                <th class="px-6 py-4 text-left text-sm font-medium text-gray-300">Plan</th>
                                <th class="px-6 py-4 text-left text-sm font-medium text-gray-300">DMs Used</th>
                                <th class="px-6 py-4 text-left text-sm font-medium text-gray-300">Status</th>
                                <th class="px-6 py-4 text-left text-sm font-medium text-gray-300">Joined</th>
                                <th class="px-6 py-4 text-left text-sm font-medium text-gray-300">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="adminUsersTable2" class="divide-y divide-gray-700">
                            <!-- Users loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- Plans & Pricing Section -->
            <section id="plansSection" class="hidden">
                <h1 class="text-3xl font-bold mb-8">Plans & Pricing Management</h1>
                
                <div class="grid lg:grid-cols-3 gap-6">
                    <!-- Starter Plan -->
                    <div class="bg-gray-800 rounded-2xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-xl font-bold">Starter Plan</h3>
                            <span class="px-3 py-1 bg-blue-600/20 text-blue-400 rounded-full text-sm">Active</span>
                        </div>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">Monthly Price (‚Çπ)</label>
                                <input type="number" id="starterMonthly" value="499" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">Yearly Price (‚Çπ)</label>
                                <input type="number" id="starterYearly" value="4790" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">DM Limit (per month)</label>
                                <input type="number" id="starterDmLimit" value="500" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">Account Limit</label>
                                <input type="number" id="starterAccountLimit" value="1" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Pro Plan -->
                    <div class="bg-gray-800 rounded-2xl p-6 border-2 border-purple-600">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-xl font-bold">Pro Plan</h3>
                            <span class="px-3 py-1 bg-purple-600/20 text-purple-400 rounded-full text-sm">Popular</span>
                        </div>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">Monthly Price (‚Çπ)</label>
                                <input type="number" id="proMonthly" value="999" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">Yearly Price (‚Çπ)</label>
                                <input type="number" id="proYearly" value="9590" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">DM Limit (per month)</label>
                                <input type="number" id="proDmLimit" value="2000" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">Account Limit</label>
                                <input type="number" id="proAccountLimit" value="3" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Enterprise Plan -->
                    <div class="bg-gray-800 rounded-2xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-xl font-bold">Enterprise Plan</h3>
                            <span class="px-3 py-1 bg-green-600/20 text-green-400 rounded-full text-sm">Premium</span>
                        </div>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">Monthly Price (‚Çπ)</label>
                                <input type="number" id="enterpriseMonthly" value="2499" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">Yearly Price (‚Çπ)</label>
                                <input type="number" id="enterpriseYearly" value="23990" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">DM Limit (per month)</label>
                                <input type="number" id="enterpriseDmLimit" value="999999" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white">
                                <p class="text-xs text-gray-500 mt-1">999999 = Unlimited</p>
                            </div>
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">Account Limit</label>
                                <input type="number" id="enterpriseAccountLimit" value="10" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8 flex gap-4">
                    <button onclick="savePlanPrices()" class="px-8 py-4 bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl font-bold hover:shadow-lg transition">
                        <i class="fas fa-save mr-2"></i> Save All Changes
                    </button>
                    <button onclick="resetPlanPrices()" class="px-8 py-4 bg-gray-700 rounded-xl font-bold hover:bg-gray-600 transition">
                        <i class="fas fa-undo mr-2"></i> Reset to Default
                    </button>
                </div>
            </section>
            
            <!-- Payments Section -->
            <section id="paymentsSection" class="hidden">
                <div class="flex items-center justify-between mb-8">
                    <h1 class="text-3xl font-bold">Payment History</h1>
                    <div class="flex gap-4">
                        <select id="paymentFilter" class="px-4 py-2 bg-gray-800 border border-gray-700 rounded-xl text-white" onchange="filterPayments()">
                            <option value="all">All Payments</option>
                            <option value="completed">Completed</option>
                            <option value="pending">Pending</option>
                            <option value="failed">Failed</option>
                        </select>
                        <button onclick="exportPayments()" class="px-4 py-2 bg-green-600 rounded-xl hover:bg-green-700 transition">
                            <i class="fas fa-download mr-2"></i> Export
                        </button>
                    </div>
                </div>
                
                <div class="bg-gray-800 rounded-2xl overflow-hidden">
                    <table class="w-full">
                        <thead class="bg-gray-700">
                            <tr>
                                <th class="px-6 py-4 text-left text-sm font-medium text-gray-300">Payment ID</th>
                                <th class="px-6 py-4 text-left text-sm font-medium text-gray-300">User</th>
                                <th class="px-6 py-4 text-left text-sm font-medium text-gray-300">Plan</th>
                                <th class="px-6 py-4 text-left text-sm font-medium text-gray-300">Amount</th>
                                <th class="px-6 py-4 text-left text-sm font-medium text-gray-300">Method</th>
                                <th class="px-6 py-4 text-left text-sm font-medium text-gray-300">Status</th>
                                <th class="px-6 py-4 text-left text-sm font-medium text-gray-300">Date</th>
                                <th class="px-6 py-4 text-left text-sm font-medium text-gray-300">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="paymentsTableBody" class="divide-y divide-gray-700">
                            <!-- Payments loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- Settings Section -->
            <section id="settingsSection" class="hidden">
                <h1 class="text-3xl font-bold mb-8">Admin Settings</h1>
                
                <div class="grid lg:grid-cols-2 gap-6">
                    <!-- General Settings -->
                    <div class="bg-gray-800 rounded-2xl p-6">
                        <h3 class="text-xl font-bold mb-6">General Settings</h3>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">Site Name</label>
                                <input type="text" id="siteName" value="InstaBot AI" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white">
                            </div>
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">Support Email</label>
                                <input type="email" id="supportEmail" value="support@instabot.ai" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Admin Credentials -->
                    <div class="bg-gray-800 rounded-2xl p-6">
                        <h3 class="text-xl font-bold mb-6">Admin Credentials</h3>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm text-gray-400 mb-2">Admin Emails (comma separated)</label>
                                <textarea id="adminEmails" rows="2" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white" placeholder="sahanapraveen2006@gmail.com, admin2@example.com">sahanapraveen2006@gmail.com</textarea>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8">
                    <button onclick="saveAdminSettings()" class="px-8 py-4 bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl font-bold hover:shadow-lg transition">
                        <i class="fas fa-save mr-2"></i> Save Settings
                    </button>
                </div>
            </section>
        </main>
    </div>
</div>

<!-- ============================== -->
<!-- MODALS -->
<!-- ============================== -->

<!-- Login Modal -->
<div id="loginModal" class="modal">
    <div class="glass-card rounded-3xl p-8 max-w-md w-full mx-4 relative">
        <button onclick="closeLoginModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times text-xl"></i></button>
        
        <div class="text-center mb-8">
            <div class="w-16 h-16 bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
                <i class="fab fa-instagram text-white text-3xl"></i>
            </div>
            <h2 class="text-2xl font-bold text-gray-900">Welcome Back</h2>
            <p class="text-gray-500">Login to your account</p>
        </div>
        
        <div id="loginForm">
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input type="email" id="loginEmail" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-600" placeholder="your@email.com">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="loginPassword" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-600" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                
                <button onclick="loginWithEmail()" class="w-full py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl font-bold hover:shadow-lg transition">Login</button>
                
                <div class="relative my-6">
                    <div class="absolute inset-0 flex items-center"><div class="w-full border-t border-gray-300"></div></div>
                    <div class="relative flex justify-center text-sm"><span class="px-2 bg-white text-gray-500">Or continue with</span></div>
                </div>
                
                <button onclick="loginWithGoogle()" class="w-full py-4 border border-gray-300 rounded-xl font-medium flex items-center justify-center gap-3 hover:bg-gray-50 transition">
                    <img src="https://www.google.com/favicon.ico" class="w-5 h-5"> Continue with Google
                </button>
                
                <p class="text-center text-gray-500 mt-4">Don't have an account? <button onclick="showSignup()" class="text-purple-600 font-medium">Sign up</button></p>
            </div>
        </div>
        
        <div id="signupForm" class="hidden">
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                    <input type="text" id="signupName" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-600" placeholder="John Doe">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input type="email" id="signupEmail" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-600" placeholder="your@email.com">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="signupPassword" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-600" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                
                <button onclick="signupWithEmail()" class="w-full py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl font-bold hover:shadow-lg transition">Create Account</button>
                
                <div class="relative my-6">
                    <div class="absolute inset-0 flex items-center"><div class="w-full border-t border-gray-300"></div></div>
                    <div class="relative flex justify-center text-sm"><span class="px-2 bg-white text-gray-500">Or continue with</span></div>
                </div>
                
                <button onclick="loginWithGoogle()" class="w-full py-4 border border-gray-300 rounded-xl font-medium flex items-center justify-center gap-3 hover:bg-gray-50 transition">
                    <img src="https://www.google.com/favicon.ico" class="w-5 h-5"> Continue with Google
                </button>
                
                <p class="text-center text-gray-500 mt-4">Already have an account? <button onclick="showLogin()" class="text-purple-600 font-medium">Login</button></p>
            </div>
        </div>
    </div>
</div>

<!-- Admin Login Modal -->
<div id="adminLoginModal" class="modal">
    <div class="glass-card rounded-3xl p-8 max-w-md w-full mx-4 relative">
        <button onclick="closeAdminLoginModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times text-xl"></i></button>
        
        <div class="text-center mb-8">
            <div class="w-16 h-16 bg-gradient-to-r from-red-600 to-orange-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-shield-alt text-white text-3xl"></i>
            </div>
            <h2 class="text-2xl font-bold text-gray-900">Admin Access</h2>
            <p class="text-gray-500">Enter admin credentials</p>
        </div>
        
        <div class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Admin Email</label>
                <input type="email" id="adminEmail" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-600" placeholder="admin@email.com" value="sahanapraveen2006@gmail.com">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Admin Password</label>
                <input type="password" id="adminPassword" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-600" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" value="rudra3745">
            </div>
            
            <button onclick="adminLogin()" class="w-full py-4 bg-gradient-to-r from-red-600 to-orange-600 text-white rounded-xl font-bold hover:shadow-lg transition">
                <i class="fas fa-lock mr-2"></i> Access Admin Panel
            </button>
            
            <div class="p-4 bg-yellow-50 rounded-xl mt-4">
                <p class="text-yellow-800 text-sm"><i class="fas fa-info-circle mr-2"></i>Default admin: sahanapraveen2006@gmail.com / rudra3745</p>
            </div>
        </div>
    </div>
</div>

<!-- Connect Instagram Modal -->
<div id="connectModal" class="modal">
    <div class="glass-card rounded-3xl p-6 lg:p-8 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-xl font-bold text-gray-800">Connect Instagram</h3>
            <button onclick="closeConnectModal()" class="text-gray-400 hover:text-gray-600 p-2">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        
        <div class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Instagram Username</label>
                <input type="text" id="igUsername" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-600" placeholder="@yourusername">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Instagram Password</label>
                <div class="relative">
                    <input type="password" id="igPassword" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-600 pr-12" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    <button type="button" onclick="togglePasswordVisibility()" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600">
                        <i id="passwordToggleIcon" class="fas fa-eye"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-4 bg-yellow-50 rounded-xl border border-yellow-200">
                <p class="text-yellow-800 text-sm"><i class="fas fa-shield-alt mr-2"></i>Your credentials are encrypted and secure. We use bank-level encryption.</p>
            </div>
            
            <button onclick="connectInstagramAccount()" class="w-full py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl font-bold hover:shadow-lg transition">
                <i class="fab fa-instagram mr-2"></i> Connect Account
            </button>
        </div>
    </div>
</div>

<!-- Payment Modal -->
<div id="paymentModal" class="modal">
    <div class="glass-card rounded-3xl p-6 lg:p-8 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-xl font-bold text-gray-800">Complete Payment</h3>
            <button onclick="closePaymentModal()" class="text-gray-400 hover:text-gray-600 p-2">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        
        <div class="text-center mb-6">
            <p class="text-gray-500">You're upgrading to</p>
            <p id="paymentPlanName" class="text-2xl font-bold text-purple-600">Pro Plan</p>
            <p class="text-3xl font-bold text-gray-800 mt-2">‚Çπ<span id="paymentAmount">999</span></p>
            <p id="paymentPeriod" class="text-sm text-gray-500">per month</p>
        </div>
        
        <div class="space-y-4">
            <button onclick="payWithRazorpay()" class="w-full py-4 bg-blue-600 text-white rounded-xl font-bold hover:bg-blue-700 transition flex items-center justify-center gap-2">
                <img src="https://razorpay.com/favicon.png" class="w-5 h-5" alt="Razorpay"> Pay with Razorpay
            </button>
            
            <button onclick="showUPISection()" class="w-full py-4 bg-green-600 text-white rounded-xl font-bold hover:bg-green-700 transition flex items-center justify-center gap-2">
                <i class="fas fa-mobile-alt"></i> Pay with UPI
            </button>
            
            <div id="upiSection" class="hidden">
                <div class="p-4 bg-gray-50 rounded-xl text-center border">
                    <p class="text-sm text-gray-600 mb-2">Scan QR or pay to UPI ID:</p>
                    <p id="displayUpiId" class="font-mono font-bold text-lg text-gray-800">yourstore@upi</p>
                    <img id="upiQR" src="" class="mx-auto mt-4 rounded-lg" alt="UPI QR Code">
                    <div class="mt-4 space-y-3">
                        <input type="text" id="upiTxnId" placeholder="Enter Transaction ID / UTR Number" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-purple-600">
                        <button onclick="verifyUPI()" class="w-full py-3 bg-purple-600 text-white rounded-xl font-medium hover:bg-purple-700 transition">
                            <i class="fas fa-check-circle mr-2"></i> Verify Payment
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Loading Modal -->
<div id="loadingModal" class="modal">
    <div class="text-center">
        <div class="loader mx-auto mb-4"></div>
        <p class="text-white text-lg font-medium" id="loadingText">Please wait...</p>
    </div>
</div>

<!-- Toast -->
<div id="toast" class="toast hide fixed bottom-4 right-4 z-50">
    <div class="bg-gray-900 text-white px-6 py-4 rounded-xl shadow-lg flex items-center gap-3 max-w-sm">
        <i id="toastIcon" class="fas fa-check-circle text-green-500 text-xl"></i>
        <span id="toastMessage" class="flex-1">Success!</span>
        <button onclick="hideToast()" class="text-gray-400 hover:text-white">
            <i class="fas fa-times"></i>
        </button>
    </div>
</div>

<!-- Razorpay Script -->
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<script>
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // üîß CONFIGURATION
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    const SUPABASE_URL = 'https://uvnksakgjupnivmfkjcv.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV2bmtzYWtnanVwbml2bWZramN2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU4NzM5NzYsImV4cCI6MjA4MTQ0OTk3Nn0.gM5hYGxnUI-n_zM-iut8Dml1T5593YhH5A9HNo8hovA';
    
    // üí∞ RAZORPAY - Add your Razorpay Key here
    const RAZORPAY_KEY = 'rzp_test_XXXXXXXXXX'; // <- REPLACE WITH YOUR KEY
    
    // üí∞ UPI - Add your UPI ID here
    const UPI_ID = 'yourstore@upi'; // <- REPLACE WITH YOUR UPI ID
    
    // üë§ ADMIN CREDENTIALS
    const ADMIN_EMAIL = 'sahanapraveen2006@gmail.com';
    const ADMIN_PASSWORD = 'rudra3745';
    const ADMIN_EMAILS = ['sahanapraveen2006@gmail.com'];
    
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // GLOBAL VARIABLES
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    let currentUser = null;
    let userProfile = null;
    let isAdmin = false;
    let selectedPlan = null;
    let billingType = 'monthly';
    let keywords = [];
    let currentUserPage = 1;
    const usersPerPage = 10;
    let allUsers = [];
    let allPayments = [];
    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // INITIALIZATION
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    document.addEventListener('DOMContentLoaded', async () => {
        // Check if user is already logged in
        const { data: { user } } = await supabase.auth.getUser();
        if (user) {
            await handleUserLogin(user);
        }
        
        // Setup event listeners
        setupEventListeners();
    });
    
    function setupEventListeners() {
        // Navigation links for user dashboard
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const section = link.dataset.section;
                if (section) {
                    showSection(section);
                    closeSidebar();
                }
            });
        });
    }
    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // PAGE NAVIGATION
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    function showLandingPage() {
        document.getElementById('landingPage').classList.remove('hidden');
        document.getElementById('userDashboard').classList.add('hidden');
        document.getElementById('adminPanel').classList.add('hidden');
    }
    
    function showUserDashboard() {
        document.getElementById('landingPage').classList.add('hidden');
        document.getElementById('userDashboard').classList.remove('hidden');
        document.getElementById('adminPanel').classList.add('hidden');
    }
    
    function showAdminPanel() {
        document.getElementById('landingPage').classList.add('hidden');
        document.getElementById('userDashboard').classList.add('hidden');
        document.getElementById('adminPanel').classList.remove('hidden');
    }
    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // USER AUTHENTICATION
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    async function handleUserLogin(user) {
        currentUser = user;
        isAdmin = ADMIN_EMAILS.includes(user.email.toLowerCase());
        
        if (isAdmin) {
            document.getElementById('adminNavLink').classList.remove('hidden');
        }
        
        await loadUserProfile();
        showUserDashboard();
        initCharts();
    }
    
    async function loadUserProfile() {
        try {
            const { data, error } = await supabase
                .from('profiles')
                .select('*')
                .eq('id', currentUser.id)
                .single();
            
            if (data) {
                userProfile = data;
                updateUI();
            } else {
                // Create profile if doesn't exist
                const newProfile = {
                    id: currentUser.id,
                    email: currentUser.email,
                    full_name: currentUser.user_metadata?.full_name || currentUser.email.split('@')[0],
                    plan: 'free',
                    dms_used: 0,
                    dms_limit: 100,
                    is_admin: isAdmin,
                    created_at: new Date().toISOString()
                };
                
                await supabase.from('profiles').insert(newProfile);
                userProfile = newProfile;
                updateUI();
            }
        } catch (error) {
            console.error('Profile load error:', error);
        }
    }
    
    function updateUI() {
        if (!userProfile) return;
        
        const name = userProfile.full_name || userProfile.email?.split('@')[0] || 'User';
        
        // Update user info
        document.getElementById('userName').textContent = name;
        document.getElementById('settingsName').value = userProfile.full_name || '';
        document.getElementById('settingsEmail').value = userProfile.email || '';
        document.getElementById('dropdownEmail').textContent = userProfile.email || '';
        
        // Update avatar
        const avatarUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&background=7c3aed&color=fff`;
        document.getElementById('userAvatar').src = avatarUrl;
        document.getElementById('settingsAvatar').src = avatarUrl;
        
        // Plan names and limits
        const planNames = { free: 'Free Plan', starter: 'Starter', pro: 'Pro', enterprise: 'Enterprise' };
        const planLimits = { free: 100, starter: 500, pro: 2000, enterprise: 999999 };
        const planLabel = planNames[userProfile.plan] || 'Free Plan';
        
        // Update plan displays
        document.getElementById('currentPlan').textContent = planLabel;
        document.getElementById('billingPlanName').textContent = planLabel;
        document.getElementById('dropdownRole').textContent = planLabel;
        document.getElementById('dmsUsed').textContent = userProfile.dms_used || 0;
        document.getElementById('dmsLimit').textContent = userProfile.plan === 'enterprise' ? '‚àû' : (planLimits[userProfile.plan] || 100);
        
        // Update billing section
        document.getElementById('billingDmsUsed').textContent = userProfile.dms_used || 0;
        document.getElementById('billingDmsLimit').textContent = userProfile.plan === 'enterprise' ? '‚àû' : (planLimits[userProfile.plan] || 100);
        
        // Usage bar
        const limit = planLimits[userProfile.plan] || 100;
        const usagePercent = userProfile.plan === 'enterprise' ? 0 : ((userProfile.dms_used || 0) / limit) * 100;
        document.getElementById('usageBar').style.width = `${Math.min(usagePercent, 100)}%`;
        
        // Update stats
        document.getElementById('totalDms').textContent = userProfile.dms_used || 0;
        document.getElementById('allTimeDms').textContent = userProfile.dms_used || 0;
        
        // Load automation settings if exists
        if (userProfile.automation_settings) {
            const settings = userProfile.automation_settings;
            document.getElementById('welcomeMessage').value = settings.welcomeMessage || '';
            document.getElementById('autoReplyMessage').value = settings.autoReplyMessage || '';
            document.getElementById('dmDelay').value = settings.dmDelay || 30;
            document.getElementById('dailyLimit').value = settings.dailyLimit || 50;
            document.getElementById('autoDmToggle').checked = settings.autoDmEnabled || false;
            document.getElementById('autoDmStatus').textContent = settings.autoDmEnabled ? 'ON' : 'OFF';
            document.getElementById('reelCommentToggle').checked = settings.reelCommentEnabled || false;
            document.getElementById('reelCommentStatus').textContent = settings.reelCommentEnabled ? 'ON' : 'OFF';
            document.getElementById('reelCommentReply').value = settings.reelCommentReply || '';
        }
    }
    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // LOGIN/SIGNUP FUNCTIONS
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    function openLoginModal() { 
        document.getElementById('loginModal').classList.add('active'); 
        document.body.style.overflow = 'hidden';
    }
    
    function closeLoginModal() { 
        document.getElementById('loginModal').classList.remove('active'); 
        document.body.style.overflow = '';
    }
    
    function showSignup() { 
        document.getElementById('loginForm').classList.add('hidden'); 
        document.getElementById('signupForm').classList.remove('hidden'); 
    }
    
    function showLogin() { 
        document.getElementById('signupForm').classList.add('hidden'); 
        document.getElementById('loginForm').classList.remove('hidden'); 
    }
    
    function showAdminLogin() {
        document.getElementById('adminLoginModal').classList.add('active');
        document.body.style.overflow = 'hidden';
    }
    
    function closeAdminLoginModal() {
        document.getElementById('adminLoginModal').classList.remove('active');
        document.body.style.overflow = '';
    }
    
    async function loginWithEmail() {
        const email = document.getElementById('loginEmail').value.trim();
        const password = document.getElementById('loginPassword').value;
        
        if (!email || !password) { 
            showToast('Please fill all fields', 'error'); 
            return; 
        }
        
        showLoading('Logging in...');
        try {
            const { data, error } = await supabase.auth.signInWithPassword({ email, password });
            if (error) throw error;
            
            await handleUserLogin(data.user);
            closeLoginModal();
            showToast('Login successful!');
        } catch (error) {
            showToast(error.message, 'error');
        } finally {
            hideLoading();
        }
    }
    
    async function signupWithEmail() {
        const name = document.getElementById('signupName').value.trim();
        const email = document.getElementById('signupEmail').value.trim();
        const password = document.getElementById('signupPassword').value;
        
        if (!name || !email || !password) { 
            showToast('Please fill all fields', 'error'); 
            return; 
        }
        
        showLoading('Creating account...');
        try {
            const { data, error } = await supabase.auth.signUp({
                email, password,
                options: { data: { full_name: name } }
            });
            if (error) throw error;
            
            // Create profile
            await supabase.from('profiles').insert({
                id: data.user.id,
                email, full_name: name,
                plan: 'free', dms_limit: 100, dms_used: 0,
                status: 'active', created_at: new Date().toISOString()
            });
            
            showToast('Account created! Please check your email.');
            setTimeout(() => showLogin(), 2000);
        } catch (error) {
            showToast(error.message, 'error');
        } finally {
            hideLoading();
        }
    }
    
    async function loginWithGoogle() {
        showLoading('Redirecting to Google...');
        try {
            const { error } = await supabase.auth.signInWithOAuth({
                provider: 'google',
                options: { redirectTo: window.location.origin }
            });
            if (error) throw error;
        } catch (error) {
            showToast(error.message, 'error');
            hideLoading();
        }
    }
    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // ADMIN FUNCTIONS
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    async function adminLogin() {
        const email = document.getElementById('adminEmail').value;
        const password = document.getElementById('adminPassword').value;
        
        if (email === ADMIN_EMAIL && password === ADMIN_PASSWORD) {
            closeAdminLoginModal();
            showAdminPanel();
            loadAdminData();
            showToast('Welcome, Admin!');
            return;
        }
        
        // Also check Supabase for admin users
        try {
            const { data, error } = await supabase.auth.signInWithPassword({
                email,
                password
            });
            
            if (error) throw error;
            
            if (ADMIN_EMAILS.includes(email.toLowerCase())) {
                closeAdminLoginModal();
                showAdminPanel();
                loadAdminData();
                showToast('Welcome, Admin!');
            } else {
                showToast('Not an admin account', 'error');
            }
        } catch (error) {
            showToast('Invalid credentials', 'error');
        }
    }
    
    function adminLogout() {
        showLandingPage();
        showToast('Admin logged out');
    }
    
    function showAdminSection(section) {
        // Hide all sections
        document.querySelectorAll('main > section').forEach(s => s.classList.add('hidden'));
        document.getElementById(`${section}Section`).classList.remove('hidden');
        
        // Update nav links
        document.querySelectorAll('.admin-nav').forEach(nav => {
            nav.classList.remove('bg-red-600');
            nav.classList.add('hover:bg-gray-700');
        });
        event.target.closest('.admin-nav')?.classList.add('bg-red-600');
        event.target.closest('.admin-nav')?.classList.remove('hover:bg-gray-700');
    }
    
    async function loadAdminData() {
        showLoading('Loading admin data...');
        
        try {
            // Load users
            const { data: users } = await supabase
                .from('profiles')
                .select('*')
                .order('created_at', { ascending: false });
            
            allUsers = users || [];
            
            // Load payments
            const { data: payments } = await supabase
                .from('payments')
                .select('*')
                .order('created_at', { ascending: false });
            
            allPayments = payments || [];
            
            // Update stats
            document.getElementById('adminTotalUsers2').textContent = allUsers.length;
            document.getElementById('adminActiveSubscriptions').textContent = allUsers.filter(u => u.plan !== 'free').length;
            
            const totalRevenue = allPayments
                .filter(p => p.status === 'completed')
                .reduce((sum, p) => sum + (p.amount || 0), 0);
            document.getElementById('adminTotalRevenue').textContent = `‚Çπ${totalRevenue.toLocaleString()}`;
            
            const totalDms = allUsers.reduce((sum, u) => sum + (u.dms_used || 0), 0);
            document.getElementById('adminTotalDmsSent').textContent = totalDms.toLocaleString();
            
            // Render tables
            renderUsersTableAdmin();
            renderPaymentsTableAdmin();
            
            // Load plan prices
            await loadPlanPrices();
            
            // Initialize charts
            initAdminCharts();
            
        } catch (error) {
            console.error('Admin data error:', error);
            showToast('Error loading admin data', 'error');
        } finally {
            hideLoading();
        }
    }
    
    function renderUsersTableAdmin() {
        const tbody = document.getElementById('adminUsersTable2');
        
        if (!allUsers || allUsers.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="7" class="px-6 py-8 text-center text-gray-400">No users found</td>
                </tr>
            `;
            return;
        }
        
        tbody.innerHTML = allUsers.slice(0, 50).map(user => `
            <tr class="hover:bg-gray-700/50">
                <td class="px-6 py-4">
                    <div class="flex items-center space-x-3">
                        <img src="https://ui-avatars.com/api/?name=${encodeURIComponent(user.full_name || 'U')}&background=7c3aed&color=fff&size=32" class="w-8 h-8 rounded-full">
                        <span class="font-medium">${escapeHtml(user.full_name || 'Unknown')}</span>
                    </div>
                </td>
                <td class="px-6 py-4 text-gray-300">${escapeHtml(user.email)}</td>
                <td class="px-6 py-4">
                    <span class="px-2 py-1 rounded-full text-xs font-medium ${
                        user.plan === 'enterprise' ? 'bg-green-100 text-green-600' :
                        user.plan === 'pro' ? 'bg-purple-100 text-purple-600' :
                        user.plan === 'starter' ? 'bg-blue-100 text-blue-600' :
                        'bg-gray-100 text-gray-600'
                    }">${user.plan?.toUpperCase() || 'FREE'}</span>
                </td>
                <td class="px-6 py-4">${user.dms_used || 0}</td>
                <td class="px-6 py-4">
                    <span class="px-3 py-1 rounded-full text-xs font-medium ${user.status === 'blocked' ? 'bg-red-600/20 text-red-400' : 'bg-green-600/20 text-green-400'}">
                        ${user.status === 'blocked' ? 'Blocked' : 'Active'}
                    </span>
                </td>
                <td class="px-6 py-4 text-gray-300">${new Date(user.created_at).toLocaleDateString()}</td>
                <td class="px-6 py-4">
                    <button onclick="adminEditUser('${user.id}')" class="text-blue-600 hover:text-blue-800 mr-2">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button onclick="adminDeleteUser('${user.id}')" class="text-red-600 hover:text-red-800">
                        <i class="fas fa-trash"></i>
                    </button>
                </td>
            </tr>
        `).join('');
    }
    
    async function loadPlanPrices() {
        try {
            const { data } = await supabase
                .from('settings')
                .select('*')
                .eq('key', 'plan_prices')
                .single();
            
            if (data?.value) {
                const prices = data.value;
                document.getElementById('starterMonthly').value = prices.starter?.monthly || 499;
                document.getElementById('starterYearly').value = prices.starter?.yearly || 4790;
                document.getElementById('starterDmLimit').value = prices.starter?.dmLimit || 500;
                document.getElementById('starterAccountLimit').value = prices.starter?.accountLimit || 1;
                
                document.getElementById('proMonthly').value = prices.pro?.monthly || 999;
                document.getElementById('proYearly').value = prices.pro?.yearly || 9590;
                document.getElementById('proDmLimit').value = prices.pro?.dmLimit || 2000;
                document.getElementById('proAccountLimit').value = prices.pro?.accountLimit || 3;
                
                document.getElementById('enterpriseMonthly').value = prices.enterprise?.monthly || 2499;
                document.getElementById('enterpriseYearly').value = prices.enterprise?.yearly || 23990;
                document.getElementById('enterpriseDmLimit').value = prices.enterprise?.dmLimit || 999999;
                document.getElementById('enterpriseAccountLimit').value = prices.enterprise?.accountLimit || 10;
            }
        } catch (error) {
            console.error('Load plan prices error:', error);
        }
    }
    
    async function savePlanPrices() {
        showLoading('Saving plan prices...');
        
        const prices = {
            starter: {
                monthly: parseInt(document.getElementById('starterMonthly').value),
                yearly: parseInt(document.getElementById('starterYearly').value),
                dmLimit: parseInt(document.getElementById('starterDmLimit').value),
                accountLimit: parseInt(document.getElementById('starterAccountLimit').value)
            },
            pro: {
                monthly: parseInt(document.getElementById('proMonthly').value),
                yearly: parseInt(document.getElementById('proYearly').value),
                dmLimit: parseInt(document.getElementById('proDmLimit').value),
                accountLimit: parseInt(document.getElementById('proAccountLimit').value)
            },
            enterprise: {
                monthly: parseInt(document.getElementById('enterpriseMonthly').value),
                yearly: parseInt(document.getElementById('enterpriseYearly').value),
                dmLimit: parseInt(document.getElementById('enterpriseDmLimit').value),
                accountLimit: parseInt(document.getElementById('enterpriseAccountLimit').value)
            }
        };
        
        try {
            const { error } = await supabase
                .from('settings')
                .upsert({
                    key: 'plan_prices',
                    value: prices,
                    updated_at: new Date().toISOString()
                });
            
            if (error) throw error;
            
            showToast('Plan prices updated successfully!');
        } catch (error) {
            showToast('Error saving prices', 'error');
        } finally {
            hideLoading();
        }
    }
    
    function resetPlanPrices() {
        document.getElementById('starterMonthly').value = 499;
        document.getElementById('starterYearly').value = 4790;
        document.getElementById('starterDmLimit').value = 500;
        document.getElementById('starterAccountLimit').value = 1;
        
        document.getElementById('proMonthly').value = 999;
        document.getElementById('proYearly').value = 9590;
        document.getElementById('proDmLimit').value = 2000;
        document.getElementById('proAccountLimit').value = 3;
        
        document.getElementById('enterpriseMonthly').value = 2499;
        document.getElementById('enterpriseYearly').value = 23990;
        document.getElementById('enterpriseDmLimit').value = 999999;
        document.getElementById('enterpriseAccountLimit').value = 10;
    }
    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // USER DASHBOARD FUNCTIONS
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebarOverlay');
        
        sidebar.classList.toggle('open');
        overlay.classList.toggle('active');
    }
    
    function closeSidebar() {
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebarOverlay');
        
        sidebar.classList.remove('open');
        overlay.classList.remove('active');
    }
    
    function toggleUserDropdown() {
        document.getElementById('userDropdown').classList.toggle('hidden');
    }
    
    function closeDropdown() {
        document.getElementById('userDropdown').classList.add('hidden');
    }
    
    function showSection(section) {
        // Hide all sections
        const sections = ['dashboard', 'automation', 'messages', 'analytics', 'accounts', 'billing', 'settings', 'admin'];
        sections.forEach(s => {
            const el = document.getElementById(`${s}Section`);
            if (el) el.classList.add('hidden');
        });
        
        // Show selected section
        const targetSection = document.getElementById(`${section}Section`);
        if (targetSection) {
            targetSection.classList.remove('hidden');
        }
        
        // Update nav links
        document.querySelectorAll('.nav-link').forEach(link => {
            link.classList.remove('active');
            if (link.dataset.section !== 'admin') {
                link.classList.add('text-gray-600');
            }
        });
        
        const activeLink = document.querySelector(`.nav-link[data-section="${section}"]`);
        if (activeLink) {
            activeLink.classList.add('active');
            activeLink.classList.remove('text-gray-600');
        }
        
        // Update page title
        const titles = {
            dashboard: 'Dashboard',
            automation: 'Automation',
            messages: 'Messages',
            analytics: 'Analytics',
            accounts: 'Instagram Accounts',
            billing: 'Billing',
            settings: 'Settings',
            admin: 'Admin Panel'
        };
        document.getElementById('pageTitle').textContent = titles[section] || 'Dashboard';
    }
    
    function toggleAutoDm() {
        const enabled = document.getElementById('autoDmToggle').checked;
        document.getElementById('autoDmStatus').textContent = enabled ? 'ON' : 'OFF';
    }
    
    function toggleReelComment() {
        const enabled = document.getElementById('reelCommentToggle').checked;
        document.getElementById('reelCommentStatus').textContent = enabled ? 'ON' : 'OFF';
    }
    
    async function saveAutomationSettings() {
        showLoading('Saving settings...');
        
        const settings = {
            welcomeMessage: document.getElementById('welcomeMessage').value,
            autoReplyMessage: document.getElementById('autoReplyMessage').value,
            dmDelay: parseInt(document.getElementById('dmDelay').value) || 30,
            dailyLimit: parseInt(document.getElementById('dailyLimit').value) || 50,
            autoDmEnabled: document.getElementById('autoDmToggle').checked,
            reelCommentEnabled: document.getElementById('reelCommentToggle').checked,
            reelCommentReply: document.getElementById('reelCommentReply').value
        };
        
        try {
            const { error } = await supabase
                .from('profiles')
                .update({ automation_settings: settings })
                .eq('id', currentUser.id);
            
            if (error) throw error;
            
            userProfile.automation_settings = settings;
            showToast('Settings saved successfully!');
        } catch (err) {
            showToast('Error saving settings', 'error');
        } finally {
            hideLoading();
        }
    }
    
    function addReelKeyword() {
        const keyword = document.getElementById('newReelKeyword').value.trim();
        const response = document.getElementById('newReelResponse').value.trim();
        
        if (!keyword || !response) {
            showToast('Please fill both keyword and response', 'error');
            return;
        }
        
        // Add to UI
        const list = document.getElementById('reelKeywordsList');
        const newItem = document.createElement('div');
        newItem.className = 'flex items-center justify-between p-2 bg-gray-50 rounded-lg';
        newItem.innerHTML = `
            <span class="font-medium">"${escapeHtml(keyword)}"</span>
            <span class="text-sm text-gray-600">Reply: ${escapeHtml(response)}</span>
            <button class="text-red-500 hover:text-red-700" onclick="this.parentElement.remove()"><i class="fas fa-trash"></i></button>
        `;
        list.appendChild(newItem);
        
        // Clear inputs
        document.getElementById('newReelKeyword').value = '';
        document.getElementById('newReelResponse').value = '';
        
        showToast('Keyword added');
    }
    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // BILLING FUNCTIONS
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    function switchBilling(type) {
        billingType = type;
        const monthlyBtn = document.getElementById('monthlyBtn');
        const yearlyBtn = document.getElementById('yearlyBtn');
        
        if (type === 'monthly') {
            monthlyBtn.classList.add('bg-white', 'shadow', 'text-purple-600');
            monthlyBtn.classList.remove('text-gray-600');
            yearlyBtn.classList.remove('bg-white', 'shadow', 'text-purple-600');
            yearlyBtn.classList.add('text-gray-600');
        } else {
            yearlyBtn.classList.add('bg-white', 'shadow', 'text-purple-600');
            yearlyBtn.classList.remove('text-gray-600');
            monthlyBtn.classList.remove('bg-white', 'shadow', 'text-purple-600');
            monthlyBtn.classList.add('text-gray-600');
        }
        
        document.querySelectorAll('.price-amount').forEach(el => el.textContent = el.dataset[type]);
        document.querySelectorAll('.billing-text').forEach(el => el.textContent = type === 'monthly' ? '/month' : '/year');
    }
    
    function selectPlan(plan) {
        openLoginModal();
        showToast(`Please login to select ${plan} plan`);
    }
    
    function switchBillingType(type) {
        billingType = type;
        
        const monthlyBtn = document.getElementById('billingMonthlyBtn');
        const yearlyBtn = document.getElementById('billingYearlyBtn');
        
        if (type === 'monthly') {
            monthlyBtn.classList.add('bg-white', 'shadow', 'text-purple-600');
            monthlyBtn.classList.remove('text-gray-600');
            yearlyBtn.classList.remove('bg-white', 'shadow', 'text-purple-600');
            yearlyBtn.classList.add('text-gray-600');
        } else {
            yearlyBtn.classList.add('bg-white', 'shadow', 'text-purple-600');
            yearlyBtn.classList.remove('text-gray-600');
            monthlyBtn.classList.remove('bg-white', 'shadow', 'text-purple-600');
            monthlyBtn.classList.add('text-gray-600');
        }
        
        document.querySelectorAll('.plan-price').forEach(el => {
            el.textContent = el.dataset[type];
        });
        
        document.querySelectorAll('.plan-period').forEach(el => {
            el.textContent = type === 'monthly' ? '/month' : '/year';
        });
    }
    
    function selectUpgradePlan(plan) {
        selectedPlan = plan;
        
        const prices = {
            starter: { monthly: 499, yearly: 4790 },
            pro: { monthly: 999, yearly: 9590 },
            enterprise: { monthly: 2499, yearly: 23990 }
        };
        
        const planNames = { starter: 'Starter', pro: 'Pro', enterprise: 'Enterprise' };
        
        document.getElementById('paymentPlanName').textContent = planNames[plan] + ' Plan';
        document.getElementById('paymentAmount').textContent = prices[plan][billingType];
        document.getElementById('paymentPeriod').textContent = billingType === 'monthly' ? 'per month' : 'per year';
        
        document.getElementById('paymentModal').classList.add('active');
        document.body.style.overflow = 'hidden';
    }
    
    function closePaymentModal() {
        document.getElementById('paymentModal').classList.remove('active');
        document.body.style.overflow = '';
        document.getElementById('upiSection').classList.add('hidden');
        document.getElementById('upiTxnId').value = '';
    }
    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // UTILITY FUNCTIONS
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    function toggleMobileMenu() { 
        document.getElementById('mobileMenu').classList.toggle('hidden'); 
    }
    
    function toggleFaq(button) {
        const content = button.nextElementSibling;
        const icon = button.querySelector('i');
        content.classList.toggle('hidden');
        icon.classList.toggle('rotate-180');
    }
    
    function showLoading(text = 'Please wait...') {
        document.getElementById('loadingText').textContent = text;
        document.getElementById('loadingModal').classList.add('active');
    }
    
    function hideLoading() {
        document.getElementById('loadingModal').classList.remove('active');
    }
    
    function showToast(message, type = 'success') {
        const toast = document.getElementById('toast');
        const icon = document.getElementById('toastIcon');
        const msg = document.getElementById('toastMessage');
        
        msg.textContent = message;
        
        if (type === 'success') {
            icon.className = 'fas fa-check-circle text-green-500 text-xl';
        } else if (type === 'error') {
            icon.className = 'fas fa-exclamation-circle text-red-500 text-xl';
        } else {
            icon.className = 'fas fa-info-circle text-blue-500 text-xl';
        }
        
        toast.classList.remove('hide');
        toast.classList.add('show');
        
        setTimeout(() => {
            hideToast();
        }, 4000);
    }
    
    function hideToast() {
        const toast = document.getElementById('toast');
        toast.classList.remove('show');
        toast.classList.add('hide');
    }
    
    function escapeHtml(text) {
        if (!text) return '';
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }
    
    async function logout() {
        showLoading('Logging out...');
        try {
            await supabase.auth.signOut();
            showLandingPage();
            showToast('Logged out successfully');
        } catch (err) {
            showLandingPage();
        } finally {
            hideLoading();
        }
    }
    
    async function updateProfile() {
        const name = document.getElementById('settingsName').value.trim();
        const phone = document.getElementById('settingsPhone').value.trim();
        
        if (!name) {
            showToast('Name cannot be empty', 'error');
            return;
        }
        
        showLoading('Updating profile...');
        
        try {
            const { error } = await supabase
                .from('profiles')
                .update({
                    full_name: name,
                    phone: phone,
                    updated_at: new Date().toISOString()
                })
                .eq('id', currentUser.id);
            
            if (error) throw error;
            
            showToast('Profile updated successfully!');
            await loadUserProfile();
        } catch (err) {
            showToast('Error updating profile', 'error');
        } finally {
            hideLoading();
        }
    }
    
    async function deleteAccount() {
        if (!confirm('‚ö†Ô∏è Are you sure you want to delete your account?\n\nThis action CANNOT be undone!')) return;
        
        showLoading('Deleting account...');
        
        try {
            await supabase.from('profiles').delete().eq('id', currentUser.id);
            await supabase.auth.signOut();
            showLandingPage();
            showToast('Account deleted successfully');
        } catch (err) {
            hideLoading();
            showToast('Error deleting account', 'error');
        }
    }
    
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // CHART INITIALIZATION
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    function initCharts() {
        // DM Activity Chart
        const dmCtx = document.getElementById('dmChart')?.getContext('2d');
        if (dmCtx) {
            new Chart(dmCtx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'DMs Sent',
                        data: [12, 19, 15, 25, 22, 30, 28],
                        borderColor: '#7c3aed',
                        backgroundColor: 'rgba(124, 58, 237, 0.1)',
                        fill: true,
                        tension: 0.4,
                        borderWidth: 2,
                        pointBackgroundColor: '#7c3aed',
                        pointRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        }
        
        // Response Chart
        const respCtx = document.getElementById('responseChart')?.getContext('2d');
        if (respCtx) {
            new Chart(respCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Replied', 'No Reply', 'Pending'],
                    datasets: [{
                        data: [65, 25, 10],
                        backgroundColor: ['#10b981', '#ef4444', '#f59e0b'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { 
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true
                            }
                        } 
                    },
                    cutout: '60%'
                }
            });
        }
    }
    
    function initAdminCharts() {
        // User Growth Chart
        const userCtx = document.getElementById('userGrowthChart')?.getContext('2d');
        if (userCtx) {
            new Chart(userCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Users',
                        data: [50, 120, 200, 350, 500, 750],
                        borderColor: '#7c3aed',
                        backgroundColor: 'rgba(124, 58, 237, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { grid: { color: 'rgba(255,255,255,0.1)' } },
                        x: { grid: { color: 'rgba(255,255,255,0.1)' } }
                    }
                }
            });
        }
        
        // Revenue Chart
        const revCtx = document.getElementById('revenueChart')?.getContext('2d');
        if (revCtx) {
            new Chart(revCtx, {
                type: 'bar',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Revenue (‚Çπ)',
                        data: [15000, 25000, 40000, 55000, 75000, 95000],
                        backgroundColor: '#ec4899'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { grid: { color: 'rgba(255,255,255,0.1)' } },
                        x: { grid: { color: 'rgba(255,255,255,0.1)' } }
                    }
                }
            });
        }
    }
    
    // Handle escape key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            closeLoginModal();
            closeAdminLoginModal();
            closeConnectModal();
            closePaymentModal();
            closeSidebar();
        }
    });
    
    // Initialize billing toggle
    switchBilling('monthly');
    switchBillingType('monthly');
</script>
</bodt>
</html>
